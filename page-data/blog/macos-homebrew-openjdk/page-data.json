{"componentChunkName":"component---src-templates-blog-post-js","path":"/blog/macos-homebrew-openjdk/","result":{"data":{"site":{"siteMetadata":{"author":{"name":"Johnathan Gilday"},"blogTitle":"/ gilday / blog"}},"markdownRemark":{"id":"3a34bedb-0434-5794-9757-f2b36bdac7c1","excerpt":"Update 2021-10-13: AdoptOpenJDK has migrated to the Eclipse Foundation and is\nnow Temurin. This post has been updated to reflect this migration. Changes to how…","html":"<p><strong>Update 2021-10-13: AdoptOpenJDK has migrated to the Eclipse Foundation and is\nnow Temurin. This post has been updated to reflect this migration.</strong></p>\n<p>Changes to how Java is released and licensed may have macOS users feeling more\nlost than usual when considering their options for installing the JDK. Given the\nlicensing changes Oracle made to Java after version 1.8, using Oracle’s\ninstaller may not always be an option. With Java’s new six-month release cycle,\ndevelopers are more likely to need a handful of different versions of the JDK\ninstalled. In this post, I explain how I use Homebrew to install Eclipse Temurin\npackages and manage multiple versions of Java with built-in shell tools.</p>\n<h2>Installing Java</h2>\n<ol>\n<li>\n<p><a href=\"https://docs.oracle.com/javase/8/docs/technotes/guides/install/mac_jdk.html#A1096903\">Uninstall any existing JDKs</a>.</p>\n<p>Execute <code>java -version</code> to double-check that Java is truly gone from the\nenvironment.</p>\n</li>\n<li>\n<p>Add the Cask Versions Tap. This is necessary to install previous releases.</p>\n<pre class=\"grvsc-container solarized-light grvsc-mm-t6zo1R\" data-language=\"shell\" data-index=\"0\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\">brew tap homebrew/cask-versions</span></span></code></pre>\n</li>\n<li>\n<p>Find the Eclipse Temurin HomeBrew packages for the versions of Java you need</p>\n<pre class=\"grvsc-container solarized-light grvsc-mm-t6zo1R\" data-language=\"shell\" data-index=\"1\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\">brew search temurin</span></span></code></pre>\n</li>\n<li>\n<p>Install the JDK versions you need e.g.</p>\n<pre class=\"grvsc-container solarized-light grvsc-mm-t6zo1R\" data-language=\"shell\" data-index=\"2\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\">brew install --cask temurin11</span></span></code></pre>\n</li>\n<li>\n<p>Configure <code>JAVA_HOME</code> in your shell with the default version of Java. This\nguide assumes you use ZSH because that is the default shell since macOS\nCatalina</p>\n<pre class=\"grvsc-container solarized-light grvsc-mm-t6zo1R\" data-language=\"shell\" data-index=\"3\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"> export JAVA_HOME=$(/usr/libexec/java_home -v 11)</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"> path+=$JAVA_HOME/bin</span></span></code></pre>\n</li>\n<li>\n<p>Reload the shell configuration confirm that Java works</p>\n<pre class=\"grvsc-container solarized-light grvsc-mm-t6zo1R\" data-language=\"shell\" data-index=\"4\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\">. ~/.zshrc</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">java -version</span></span></code></pre>\n</li>\n</ol>\n<h2>Switching Java Versions</h2>\n<p>Users can install multiple JDKs by installing multiple Temurin HomeBrew\npackages. The macOS program <code>/usr/libexec/java_home</code> helps users configure their\n<code>JAVA_HOME</code> environment variable.</p>\n<pre class=\"grvsc-container solarized-light grvsc-mm-t6zo1R\" data-language=\"shell\" data-index=\"5\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"># switches to JDK 14</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">export JAVA_HOME=$(/usr/libexec/java_home -v 14)</span></span></code></pre>\n<p>There is no need to update the <code>PATH</code> variable. The ZSH <code>path</code> array will\nautomatically update to reflect the changes to the <code>JAVA_HOME</code> variable.</p>\n<p>This command may be too verbose to type every time, so the\n<a href=\"https://github.com/AdoptOpenJDK/homebrew-openjdk\">HomeBrew AdoptOpenJDK Tap README recommends adding this function to your shell configuration to succinctly switch your JDK version</a>:</p>\n<pre class=\"grvsc-container solarized-light grvsc-mm-t6zo1R\" data-language=\"shell\" data-index=\"6\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\">jdk() {</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">    version=$1</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">    export JAVA_HOME=$(/usr/libexec/java_home -v&quot;$version&quot;);</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">    java -version</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">}</span></span></code></pre>\n<h3>Automatically Switching Java Versions</h3>\n<p>The command <code>jdk 1.8</code> is succinct, but you still need to remember to type it\nwhen switching between a handful of different projects. To save yourself the\ntrouble of remembering, you can configure your shell to automatically update\n<code>JAVA_HOME</code> whenever you change to your project’s directory. This is a popular\nfeature in shell scripts like <a href=\"https://www.jenv.be/\">jenv</a> and\n<a href=\"https://virtualenvwrapper.readthedocs.io/en/latest/tips.html#automatically-run-workon-when-entering-a-directory\">virtualenv</a>.\nFortunately, this feature is incredibly easy to emulate with some ZSH\nconfiguration.</p>\n<p>First, in your project’s root directory, store the version of Java the project\nrequires in a new <code>.java-version</code> file. The name <code>.java-version</code> is significant\nonly because this is the same name that the analogous jenv feature uses, and\nusing a common name helps share this configuration with any jenv users that\ncontribute to your project.</p>\n<pre class=\"grvsc-container solarized-light grvsc-mm-t6zo1R\" data-language=\"shell\" data-index=\"7\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\">echo 1.8 &gt; .java-version</span></span></code></pre>\n<p>Next, we need to add a hook to our ZSH configuration that will look for and act\non this file whenever the shell changes directories. Add the following to\n<code>$HOME/.zshrc</code>.</p>\n<pre class=\"grvsc-container solarized-light grvsc-mm-t6zo1R\" data-language=\"shell\" data-index=\"8\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"># automatic java_home switch when .java-version detected</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">function chpwd() {</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">  if [[ -f $PWD/.java-version ]]; then</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">    version=$(cat $PWD/.java-version)</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">    export JAVA_HOME=$(/usr/libexec/java_home -v $version)</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">  fi</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">}</span></span></code></pre>\n<p>Lastly, reload your ZSH configuration and test it out</p>\n<pre class=\"grvsc-container solarized-light grvsc-mm-t6zo1R\" data-language=\"shell\" data-index=\"9\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"># create two test project directories</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">mkdir java-8-project java-11-project</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"># configure each test project directory to use a different version of Java</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">echo 1.8 &gt; java-8-project/.java-version</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">echo 11 &gt; java-11-project/.java-version</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"># test Java version in java-8-project</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">cd java-8-project</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">java -version</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"># switch to java-11-project and test Java version</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">cd ../java-11-project</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">java -version</span></span></code></pre>\n<h2>Why not use the Oracle installer?</h2>\n<p>Traditionally, the most straightforward way to download Java has always been to\nsearch “download Java” and follow the first link from Oracle to download the\nmacOS installer. Oracle’s macOS installer takes care of installing and\nautomatically updating Java. One of the problems with the installer is that it\nwill insist on upgrading to the latest version of Java. Especially given Java’s\nnew six-month release cycle, upgrading to the latest version is probably too\nvolatile for most large projects.</p>\n<p>The installer is not the only reason you might avoid a Java release from Oracle.\nOracle has made its licensing more restrictive, and you may need a paid\nsubscription to use it. For example, After April 16, 2019, developers can no\nlonger use Oracle’s Java 1.8 release for commercial purposes without buying a\nsubscription.</p>\n<h2>Why Eclipse Temurin?</h2>\n<p>There are a lot of OpenJDK distributions to choose from. The excellent article\n<a href=\"https://medium.com/@javachampions/java-is-still-free-2-0-0-6b9aa8d6d244\">Is Java Still Free</a>\nis the best resource for navigating these choices. The two most important things\nto remember are:</p>\n<ol>\n<li>The open-source project OpenJDK does not distribute binary releases. It makes\nthe OpenJDK source code available for others to build and distribute OpenJDK\ndistributions.</li>\n<li>Companies and organizations that provide OpenJDK distributions differentiate\ntheir offerings primarily through maintenance, support, and added features.</li>\n</ol>\n<p>The average Java developer wants an OpenJDK distribution that is simple, free,\nhas no strings attached, and is easy to install. OpenJDK distributions from the\nEclipse Temurin project fit these criteria well. Temurin, formerly AdoptOpenJDK,\nis part of the Eclipse Foundation and makes OpenJDK distributions freely\navailable. They do not offer commercial support, so they are not trying to\nup-sell developers. Their mission is</p>\n<blockquote>\n<p>Providing the Java community with rock-solid runtimes and associated tools\nthat can be used free of charge, without usage restrictions on a wide range of\nplatforms.</p>\n</blockquote>\n<p>Sounds good to me 😁. Temurin is readily available in Docker images on\n<a href=\"https://hub.docker.com/_/eclipse-temurin\">Docker Hub</a>, in\n<a href=\"https://github.com/AdoptOpenJDK/homebrew-openjdk\">HomeBrew packages</a>, and in\narchives on <a href=\"https://adoptium.net\">adoptium.net</a>.</p>\n<style class=\"grvsc-styles\">\n  .grvsc-container {\n    overflow: auto;\n    position: relative;\n    -webkit-overflow-scrolling: touch;\n    padding-top: 1rem;\n    padding-top: var(--grvsc-padding-top, var(--grvsc-padding-v, 1rem));\n    padding-bottom: 1rem;\n    padding-bottom: var(--grvsc-padding-bottom, var(--grvsc-padding-v, 1rem));\n    border-radius: 8px;\n    border-radius: var(--grvsc-border-radius, 8px);\n    font-feature-settings: normal;\n    line-height: 1.4;\n  }\n  \n  .grvsc-code {\n    display: table;\n  }\n  \n  .grvsc-line {\n    display: table-row;\n    box-sizing: border-box;\n    width: 100%;\n    position: relative;\n  }\n  \n  .grvsc-line > * {\n    position: relative;\n  }\n  \n  .grvsc-gutter-pad {\n    display: table-cell;\n    padding-left: 0.75rem;\n    padding-left: calc(var(--grvsc-padding-left, var(--grvsc-padding-h, 1.5rem)) / 2);\n  }\n  \n  .grvsc-gutter {\n    display: table-cell;\n    -webkit-user-select: none;\n    -moz-user-select: none;\n    user-select: none;\n  }\n  \n  .grvsc-gutter::before {\n    content: attr(data-content);\n  }\n  \n  .grvsc-source {\n    display: table-cell;\n    padding-left: 1.5rem;\n    padding-left: var(--grvsc-padding-left, var(--grvsc-padding-h, 1.5rem));\n    padding-right: 1.5rem;\n    padding-right: var(--grvsc-padding-right, var(--grvsc-padding-h, 1.5rem));\n  }\n  \n  .grvsc-source:empty::after {\n    content: ' ';\n    -webkit-user-select: none;\n    -moz-user-select: none;\n    user-select: none;\n  }\n  \n  .grvsc-gutter + .grvsc-source {\n    padding-left: 0.75rem;\n    padding-left: calc(var(--grvsc-padding-left, var(--grvsc-padding-h, 1.5rem)) / 2);\n  }\n  \n  /* Line transformer styles */\n  \n  .grvsc-has-line-highlighting > .grvsc-code > .grvsc-line::before {\n    content: ' ';\n    position: absolute;\n    width: 100%;\n  }\n  \n  .grvsc-line-diff-add::before {\n    background-color: var(--grvsc-line-diff-add-background-color, rgba(0, 255, 60, 0.2));\n  }\n  \n  .grvsc-line-diff-del::before {\n    background-color: var(--grvsc-line-diff-del-background-color, rgba(255, 0, 20, 0.2));\n  }\n  \n  .grvsc-line-number {\n    padding: 0 2px;\n    text-align: right;\n    opacity: 0.7;\n  }\n  \n  .solarized-light { background-color: #FDF6E3; }\n  .solarized-light .grvsc-line-highlighted::before {\n    background-color: var(--grvsc-line-highlighted-background-color, rgba(0, 0, 0, 0.05));\n    box-shadow: inset var(--grvsc-line-highlighted-border-width, 4px) 0 0 0 var(--grvsc-line-highlighted-border-color, rgba(0, 0, 0, 0.2));\n  }\n  \n  /* Solarized Dark */\n  @media (prefers-color-scheme: dark) {\n    .grvsc-mm-t6zo1R { background-color: #002B36; }\n    .grvsc-mm-t6zo1R .grvsc-line-highlighted::before {\n      background-color: var(--grvsc-line-highlighted-background-color, rgba(255, 255, 255, 0.1));\n      box-shadow: inset var(--grvsc-line-highlighted-border-width, 4px) 0 0 0 var(--grvsc-line-highlighted-border-color, rgba(255, 255, 255, 0.5));\n    }\n  }\n</style>","frontmatter":{"title":"🍎 Installing and Managing Java on macOS","date":"September 07, 2020","description":"Developers on macOS may feel more lost than usual when considering their options for installing Java. In my experience, using Homebrew to install Eclipse Temurin packages is the best general solution for installing Java on macOS.\n"}}},"pageContext":{"slug":"/blog/macos-homebrew-openjdk/","previous":{"fields":{"slug":"/blog/hello-world/","sourceName":"blog"},"frontmatter":{"title":"🎉 Hello World!"}},"next":{"fields":{"slug":"/blog/owasp-xxe-jaxb/","sourceName":"blog"},"frontmatter":{"title":"🔒 XML External Entity Pitfalls With JAXB"}}}},"staticQueryHashes":["2841359383","614056702"],"slicesMap":{}}